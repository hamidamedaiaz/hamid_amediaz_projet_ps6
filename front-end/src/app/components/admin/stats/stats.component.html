<div class="stats-dashboard">
    <div class="dashboard-header">
      <div class="global-stats">
        <div class="stat-card">
          <h3>Utilisateurs Total</h3>
          <p>{{ stats?.totalUsers }}</p>
        </div>
        <div class="stat-card">
          <h3>Quiz Disponibles</h3>
          <p>{{ stats?.totalQuizzes }}</p>
        </div>
        <div class="stat-card">
          <h3>Parties Jouées</h3>
          <p>{{ stats?.totalGamesPlayed }}</p>
        </div>
      </div>
    </div>
  
    <div class="dashboard-content">
      <div class="stats-grid">
        <!-- Top Utilisateurs -->
        <div class="stats-section user-stats">
          <h2>Top Utilisateurs</h2>
          <table>
            <thead>
              <tr>
                <th>Nom</th>
                <th>Quiz Joués</th>
                <th>Score Moyen</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let user of stats?.userStats.mostActiveUsers">
                <td>{{ user.name }} {{ user.lastName }}</td>
                <td>{{ user.totalQuizzesTaken }}</td>
                <td>{{ user.averageScore | number:'1.1-1' }}%</td>
              </tr>
            </tbody>
          </table>
        </div>
  
        <!-- Top Quiz -->
        <div class="stats-section quiz-stats">
          <h2>Quiz Populaires</h2>
          <table>
            <thead>
              <tr>
                <th>Titre</th>
                <th>Parties</th>
                <th>Difficulté</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let quiz of stats?.quizStats.mostPlayedQuizzes">
                <td>{{ quiz.title }}</td>
                <td>{{ quiz.totalPlays }}</td>
                <td>
                  <span 
                    class="difficulty" 
                    [ngClass]="{
                      'easy': quiz.difficulty === 'Easy', 
                      'medium': quiz.difficulty === 'Medium', 
                      'hard': quiz.difficulty === 'Hard'
                    }">
                    {{ quiz.difficulty }}
                  </span>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
  
        <!-- Répartition des Catégories -->
        <div class="stats-section category-distribution">
          <h2>Répartition des Catégories</h2>
          <div class="category-bars">
            <div 
              *ngFor="let category of stats?.quizStats.categoriesDistribution" 
              class="category-bar" 
              [style.width.%]="category.percentage"
              [title]="category.category + ': ' + category.count + ' quiz'">
              {{ category.category }} ({{ category.percentage }}%)
            </div>
          </div>
        </div>
  
        <!-- Séries Temporelles -->
        <div class="stats-section time-series">
          <h2>Activité Quotidienne</h2>
          <div class="time-series-charts">
            <div class="chart-container">
              <h3>Utilisateurs Actifs</h3>
              <div class="custom-line-chart">
                <div 
                  *ngFor="let point of stats?.timeSeriesData.dailyActiveUsers" 
                  class="chart-point"
                  [style.height.%]="calculateChartHeight(stats?.timeSeriesData.dailyActiveUsers)"
                  [title]="point.value.toString()">
                </div>
              </div>
            </div>
            <div class="chart-container">
              <h3>Quiz Joués</h3>
              <div class="custom-line-chart">
                <div 
                  *ngFor="let point of stats?.timeSeriesData.dailyQuizzesTaken" 
                  class="chart-point"
                  [style.height.%]="calculateChartHeight(stats?.timeSeriesData.dailyQuizzesTaken)"
                  [title]="point.value.toString()">
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>